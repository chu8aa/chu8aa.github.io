<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>小z的笔记本</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="小z的笔记本">
<meta property="og:url" content="https://chu8aa.github.io/index.html">
<meta property="og:site_name" content="小z的笔记本">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="chu8aa">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">小z的笔记本</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://chu8aa.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-背包问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/13/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2020-02-13T05:55:01.000Z" itemprop="datePublished">2020-02-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/13/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/">背包问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="01-背包问题"><a href="#01-背包问题" class="headerlink" title="01 背包问题"></a>01 背包问题</h5><p>有$N$件物品，有一个总花费$V$，每件物品有一个花费$V_i$ 和其他一些属性，<strong>每件物品只能选择一次</strong>，在不超过总花费的情况下，使得一个属性 最大 最小 或者 数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">体积最多是 j 	初始化全部是 0	  </span><br><span class="line">						 保证每次操作必须要 &gt;&#x3D;0         （不超过j</span><br><span class="line">体积恰好是 j   初始化 f[0] &#x3D; 0 f[1..] &#x3D; +(-)INF</span><br><span class="line">						 保证每次操作必须要 &gt;&#x3D;0</span><br><span class="line">体积至少是 j   初始化 f[0] &#x3D; 0 f[1..] &#x3D; +(-)INF</span><br><span class="line">						 可以为负数 将其置为 0 就行      （看下面潜水员那题 正负INF 看题目求最大值还是最小值</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">有 N 件物品和一个容量是 V 的背包。每件物品只能使用一次。</span><br><span class="line"></span><br><span class="line">第 i 件物品的体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品数量和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行两个整数 vi,wi，用空格隔开，分别表示第 i 件物品的体积和价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 1000</span><br><span class="line">0 &lt; vi,wi ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, M = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> dp[N][M];</span><br><span class="line"><span class="keyword">int</span> f[M];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> v[N], w[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v[i]) dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[i - <span class="number">1</span>][j - v[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[n][m];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v[i]; --j) &#123;</span><br><span class="line">            f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="采药"><a href="#采药" class="headerlink" title="采药"></a>采药</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">辰辰是个天资聪颖的孩子，他的梦想是成为世界上最伟大的医师。</span><br><span class="line"></span><br><span class="line">为此，他想拜附近最有威望的医师为师。</span><br><span class="line"></span><br><span class="line">医师为了判断他的资质，给他出了一个难题。</span><br><span class="line"></span><br><span class="line">医师把他带到一个到处都是草药的山洞里对他说：“孩子，这个山洞里有一些不同的草药，采每一株都需要一些时间，每一株也有它自身的价值。我会给你一段时间，在这段时间里，你可以采到一些草药。如果你是一个聪明的孩子，你应该可以让采到的草药的总价值最大。”</span><br><span class="line"></span><br><span class="line">如果你是辰辰，你能完成这个任务吗？</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">输入文件的第一行有两个整数T和M，用一个空格隔开，T代表总共能够用来采药的时间，M代表山洞里的草药的数目。</span><br><span class="line"></span><br><span class="line">接下来的M行每行包括两个在1到100之间（包括1和100）的整数，分别表示采摘某株草药的时间和这株草药的价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出文件包括一行，这一行只包含一个整数，表示在规定的时间内，可以采到的草药的最大总价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">1 ≤ T ≤ 1000,</span><br><span class="line">1 ≤ M ≤ 100</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">花费 ：时间  --&gt; 体积 v1[i]</span><br><span class="line">价值 ：价值  --&gt; 价值 w[i]</span><br><span class="line">总时间 ： 总花费 --&gt; 总花费 V</span><br><span class="line">dp[i][j] &#x3D; max ( dp[i - 1][j] , dp[i - 1][j - v1[i]] + w[i])</span><br><span class="line">属性 ： 前 i 个物品，时间不超过 j 的最大价值 max</span><br><span class="line">dp[n][V] 就是答案</span><br></pre></td></tr></table></figure>
<h6 id="装箱问题"><a href="#装箱问题" class="headerlink" title="装箱问题"></a>装箱问题</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">有一个箱子容量为 V，同时有 n 个物品，每个物品有一个体积（正整数）。</span><br><span class="line"></span><br><span class="line">要求 n 个物品中，任取若干个装入箱内，使箱子的剩余空间为最小。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行是一个整数 V，表示箱子容量。</span><br><span class="line"></span><br><span class="line">第二行是一个整数 n，表示物品数。</span><br><span class="line"></span><br><span class="line">接下来 n 行，每行一个正整数（不超过10000），分别表示这 n 个物品的各自体积。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">一个整数，表示箱子剩余空间。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; V ≤ 20000,</span><br><span class="line">0 &lt; n ≤ 30</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">花费 ：体积 v[i]</span><br><span class="line">价值 ：体积</span><br><span class="line">总花费 ：箱子总容量 V</span><br><span class="line">dp[i][j] &#x3D; max(dp[i - 1][j] , dp[i - 1][j - v[i]] + v[i])</span><br><span class="line">属性 ：前 i 个物品中 体积不超过 j 的最大体积 max</span><br><span class="line">答案 ： V - dp[n][V]</span><br></pre></td></tr></table></figure>
<h6 id="宠物小精灵之收服"><a href="#宠物小精灵之收服" class="headerlink" title="宠物小精灵之收服"></a>宠物小精灵之收服</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">宠物小精灵是一部讲述小智和他的搭档皮卡丘一起冒险的故事。</span><br><span class="line"></span><br><span class="line">一天，小智和皮卡丘来到了小精灵狩猎场，里面有很多珍贵的野生宠物小精灵。</span><br><span class="line"></span><br><span class="line">小智也想收服其中的一些小精灵。</span><br><span class="line"></span><br><span class="line">然而，野生的小精灵并不那么容易被收服。</span><br><span class="line"></span><br><span class="line">对于每一个野生小精灵而言，小智可能需要使用很多个精灵球才能收服它，而在收服过程中，野生小精灵也会对皮卡丘造成一定的伤害（从而减少皮卡丘的体力）。</span><br><span class="line"></span><br><span class="line">当皮卡丘的体力小于等于0时，小智就必须结束狩猎（因为他需要给皮卡丘疗伤），而使得皮卡丘体力小于等于0的野生小精灵也不会被小智收服。</span><br><span class="line"></span><br><span class="line">当小智的精灵球用完时，狩猎也宣告结束。</span><br><span class="line"></span><br><span class="line">我们假设小智遇到野生小精灵时有两个选择：收服它，或者离开它。</span><br><span class="line"></span><br><span class="line">如果小智选择了收服，那么一定会扔出能够收服该小精灵的精灵球，而皮卡丘也一定会受到相应的伤害；如果选择离开它，那么小智不会损失精灵球，皮卡丘也不会损失体力。</span><br><span class="line"></span><br><span class="line">小智的目标有两个：主要目标是收服尽可能多的野生小精灵；如果可以收服的小精灵数量一样，小智希望皮卡丘受到的伤害越小（剩余体力越大），因为他们还要继续冒险。</span><br><span class="line"></span><br><span class="line">现在已知小智的精灵球数量和皮卡丘的初始体力，已知每一个小精灵需要的用于收服的精灵球数目和它在被收服过程中会对皮卡丘造成的伤害数目。</span><br><span class="line"></span><br><span class="line">请问，小智该如何选择收服哪些小精灵以达到他的目标呢？</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">输入数据的第一行包含三个整数：N，M，K，分别代表小智的精灵球数量、皮卡丘初始的体力值、野生小精灵的数量。</span><br><span class="line"></span><br><span class="line">之后的K行，每一行代表一个野生小精灵，包括两个整数：收服该小精灵需要的精灵球的数量，以及收服过程中对皮卡丘造成的伤害。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出为一行，包含两个整数：C，R，分别表示最多收服C个小精灵，以及收服C个小精灵时皮卡丘的剩余体力值最多为R。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N ≤ 1000,</span><br><span class="line">0 &lt; M ≤ 500,</span><br><span class="line">0 &lt; K ≤ 100</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">花费1 ： 精灵球数量 v1[i]</span><br><span class="line">花费2 ： 皮卡丘的体力值 v2[i]</span><br><span class="line">价值  ： 精灵数量</span><br><span class="line">dp[i][j][k] &#x3D; max(dp[i - 1][j][k] , dp[i - 1][j - v1[i]][k - v2[i]] + 1) </span><br><span class="line">属性 ： 前 i 个物品 中 选择花费1 不超过 j 和 花费2 不超过 k 的 最大物品数 max</span><br><span class="line">答案 ： dp[i][j][k - 1] 因为 k 不能为 0</span><br><span class="line">				M - z dp[i][j][z] &#x3D;&#x3D;dp[i][j][k - 1] &amp;&amp; dp[i][j][z - 1] !&#x3D; dp[i][j][k - 1]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">花费1 ： 体力 v1[i]</span><br><span class="line">花费2 ： 精灵数量</span><br><span class="line">价值  ： 精灵球数量 v2[i]</span><br><span class="line">dp[i][j][k] &#x3D; min(dp[i - 1][j][k] ,dp[i - 1][j - v1[i]][k - 1] + v2[i])</span><br><span class="line">属性 ： 前 i 个精灵 中 体力不超过 j 的 精灵数量 为 k 个的 最小使用 精灵球数量 min</span><br><span class="line">注意要初始化为 0x3f</span><br><span class="line">					dp[i - 1][j - v1[i]][k - 1] + v2[i] 要保证小与等于 给的球数 不然下面找答案的时候要保证</span><br><span class="line">答案 ： dp[N][j][k]</span><br><span class="line">			在每一个 k 的维度下 寻找 dp[N][j][k] &lt;&#x3D; n 的 最小的 j </span><br><span class="line">      第一个找到 k 就是 最大精灵数</span><br><span class="line">			在维度下的 M - j 就是剩余体力值最大</span><br></pre></td></tr></table></figure>
<h6 id="二维费用的背包问题"><a href="#二维费用的背包问题" class="headerlink" title="二维费用的背包问题"></a>二维费用的背包问题</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">有 N 件物品和一个容量是 V 的背包，背包能承受的最大重量是 M。</span><br><span class="line"></span><br><span class="line">每件物品只能用一次。体积是 vi，重量是 mi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品总体积不超过背包容量，总重量不超过背包可承受的最大重量，且价值总和最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V,M，用空格隔开，分别表示物品件数、背包容积和背包可承受的最大重量。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行三个整数 vi,mi,wi，用空格隔开，分别表示第 i 件物品的体积、重量和价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N ≤ 1000</span><br><span class="line">0 &lt; V,M ≤ 100</span><br><span class="line">0 &lt; vi,mi ≤ 100</span><br><span class="line">0 &lt; wi ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">110</span>, M = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> f[V][M];</span><br><span class="line"><span class="keyword">int</span> n, v, m, vt, mt, wt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; v &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; vt &gt;&gt; mt &gt;&gt; wt;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v; j &gt;= vt; --j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = m; k &gt;= mt; --k) &#123;</span><br><span class="line">                f[j][k] = <span class="built_in">max</span>(f[j][k], f[j - vt][k - mt] + wt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[v][m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="潜水员"><a href="#潜水员" class="headerlink" title="潜水员"></a>潜水员</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">潜水员为了潜水要使用特殊的装备。</span><br><span class="line"></span><br><span class="line">他有一个带2种气体的气缸：一个为氧气，一个为氮气。</span><br><span class="line"></span><br><span class="line">让潜水员下潜的深度需要各种数量的氧和氮。</span><br><span class="line"></span><br><span class="line">潜水员有一定数量的气缸。</span><br><span class="line"></span><br><span class="line">每个气缸都有重量和气体容量。</span><br><span class="line"></span><br><span class="line">潜水员为了完成他的工作需要特定数量的氧和氮。</span><br><span class="line"></span><br><span class="line">他完成工作所需气缸的总重的最低限度的是多少？</span><br><span class="line"></span><br><span class="line">例如：潜水员有5个气缸。每行三个数字为：氧，氮的（升）量和气缸的重量：</span><br><span class="line"></span><br><span class="line">  3 36 120</span><br><span class="line"></span><br><span class="line">  10 25 129</span><br><span class="line"></span><br><span class="line">  5 50 250</span><br><span class="line"></span><br><span class="line">  1 45 130</span><br><span class="line"></span><br><span class="line">  4 20 119</span><br><span class="line">如果潜水员需要5升的氧和60升的氮则总重最小为249（1，2或者4，5号气缸）。</span><br><span class="line"></span><br><span class="line">你的任务就是计算潜水员为了完成他的工作需要的气缸的重量的最低值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行有2个整数 m，n。它们表示氧，氮各自需要的量。</span><br><span class="line"></span><br><span class="line">第二行为整数 k 表示气缸的个数。</span><br><span class="line"></span><br><span class="line">此后的 k 行，每行包括ai，bi，ci，3个整数。这些各自是：第 i 个气缸里的氧和氮的容量及气缸重量。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">仅一行包含一个整数，为潜水员完成工作所需的气缸的重量总和的最低值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">1 ≤ m ≤ 21,</span><br><span class="line">1 ≤ n ≤ 79,</span><br><span class="line">1 ≤ k ≤ 1000,</span><br><span class="line">1 ≤ ai ≤ 21,</span><br><span class="line">1 ≤ bi ≤ 79,</span><br><span class="line">1 ≤ ci ≤ 800</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> V1 = <span class="number">25</span>, V2 = <span class="number">85</span>, N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> f[V1][V2];</span><br><span class="line"><span class="keyword">int</span> v1, v2, n, a, b, c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; v1 &gt;&gt; v2 &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v1; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = v2; k &gt;= <span class="number">0</span>; --k) &#123;</span><br><span class="line">                f[j][k] = <span class="built_in">min</span>(f[j][k], f[<span class="built_in">max</span>(j - a, <span class="number">0</span>)][<span class="built_in">max</span>(k - b, <span class="number">0</span>)] + c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[v1][v2];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="数字组合"><a href="#数字组合" class="headerlink" title="数字组合"></a>数字组合</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">给定N个正整数A1,A2,…,AN，从中选出若干个数，使它们的和为M，求有多少种选择方案。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行包含两个整数N和M。</span><br><span class="line"></span><br><span class="line">第二行包含N个整数，表示A1,A2,…,AN。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">包含一个整数，表示可选方案数。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">1 ≤ N ≤ 100,</span><br><span class="line">1 ≤ M ≤ 10000,</span><br><span class="line">1 ≤ Ai ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">花费1 ：Ai v1[i]</span><br><span class="line">价值 : Ai</span><br><span class="line">总价值 ： M</span><br><span class="line">dp[i][j] &#x3D; dp[i - 1][j]  + dp[i - 1][j - v1[i]] (不选择第 i 个物品，总价值是 j </span><br><span class="line">																								选择第 i 个物品 加上 v1[i] 总价值是j)</span><br><span class="line">属性 ： 前 i 个物品 价值是 j 的个数 count</span><br></pre></td></tr></table></figure>
<h5 id="完全背包问题"><a href="#完全背包问题" class="headerlink" title="完全背包问题"></a>完全背包问题</h5><p>有$N$件物品，有一个总花费$V$，每件物品有一个花费$V_i$ 和其他一些属性，<strong>每件物品可以选择一次或多次</strong>，在不超过总花费的情况下，使得一个属性 最大 最小 或者 数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">有 N 种物品和一个容量是 V 的背包，每种物品都有无限件可用。</span><br><span class="line"></span><br><span class="line">第 i 种物品的体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品种数和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行两个整数 vi,wi，用空格隔开，分别表示第 i 种物品的体积和价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 1000</span><br><span class="line">0 &lt;vi,wi ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> dp[N][V];</span><br><span class="line"><span class="keyword">int</span> v[N], w[N];</span><br><span class="line"><span class="keyword">int</span> f[V];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k * v[i] &lt;= j; k++) &#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i][j], dp[i - <span class="number">1</span>][j - v[i] * k] + w[i] * k);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[n][m];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v[i])</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i][j - v[i]] + w[i], dp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[n][m];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v[i]; j &lt;= m; ++j) &#123;</span><br><span class="line">            f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dp1();</span><br><span class="line">dp[i][j] &#x3D; max(dp[i -1][j] , dp[i - 1][j -v[i]] + w[i] , dp[i-1][j -2 * v[i]] + 2 * w[i] ..)</span><br><span class="line">dp[i - v[i]][j] &#x3D; max(        dp[i - 1][j -v[i]]        , dp[i -1][j - 2 * v[i]] + w[i] ...)</span><br><span class="line">其中 j - k * v[i] 一定是大于 0 的 k 一定是一样的</span><br><span class="line">所以 后面没项多一个 w[i] 再多上一项 dp[i - 1][j]</span><br></pre></td></tr></table></figure>
<h6 id="买书"><a href="#买书" class="headerlink" title="买书"></a>买书</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">小明手里有n元钱全部用来买书，书的价格为10元，20元，50元，100元。</span><br><span class="line"></span><br><span class="line">问小明有多少种买书方案？（每种书可购买多本）</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">一个整数 n，代表总共钱数。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">一个整数，代表选择方案种数。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 ≤ n ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> v1[] = &#123;<span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">100</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">5</span>][N];</span><br><span class="line"><span class="keyword">int</span> f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v1[i]) &#123;</span><br><span class="line">                dp[i][j] = dp[i][j] + dp[i][j - v1[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[<span class="number">4</span>][n];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v1[i]; j &lt;= n; ++j) &#123;</span><br><span class="line">            f[j] = f[j] + f[j - v1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="货币系统"><a href="#货币系统" class="headerlink" title="货币系统"></a>货币系统</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">给你一个n种面值的货币系统，求组成面值为m的货币有多少种方案。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行，包含两个整数n和m。</span><br><span class="line"></span><br><span class="line">接下来n行，每行包含一个整数，表示一种货币的面值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">共一行，包含一个整数，表示方案数。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">n ≤ 15,m ≤ 3000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>, M = <span class="number">3010</span>;</span><br><span class="line">LL v1[N];</span><br><span class="line">LL dp[N][M];</span><br><span class="line">LL f[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v1[i];</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v1[i]) dp[i][j] += dp[i][j - v1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[n][m];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v1[i];</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v1[i]; j &lt;= m; ++j) &#123;</span><br><span class="line">            f[j] += f[j - v1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="货币系统-1"><a href="#货币系统-1" class="headerlink" title="货币系统"></a>货币系统</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">在网友的国度中共有 n 种不同面额的货币，第 i 种货币的面额为 a[i]，你可以假设每一种货币都有无穷多张。</span><br><span class="line"></span><br><span class="line">为了方便，我们把货币种数为 n、面额数组为 a[1..n] 的货币系统记作 (n,a)。 </span><br><span class="line"></span><br><span class="line">在一个完善的货币系统中，每一个非负整数的金额 x 都应该可以被表示出，即对每一个非负整数 x，都存在 n 个非负整数 t[i] 满足 a[i]× t[i] 的和为 x。</span><br><span class="line"></span><br><span class="line">然而，在网友的国度中，货币系统可能是不完善的，即可能存在金额 x 不能被该货币系统表示出。</span><br><span class="line"></span><br><span class="line">例如在货币系统 n&#x3D;3, a&#x3D;[2,5,9] 中，金额 1,3 就无法被表示出来。 </span><br><span class="line"></span><br><span class="line">两个货币系统 (n,a) 和 (m,b) 是等价的，当且仅当对于任意非负整数 x，它要么均可以被两个货币系统表出，要么不能被其中任何一个表出。 </span><br><span class="line"></span><br><span class="line">现在网友们打算简化一下货币系统。</span><br><span class="line"></span><br><span class="line">他们希望找到一个货币系统 (m,b)，满足 (m,b) 与原来的货币系统 (n,a) 等价，且 m 尽可能的小。</span><br><span class="line"></span><br><span class="line">他们希望你来协助完成这个艰巨的任务：找到最小的 m。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">输入文件的第一行包含一个整数 T，表示数据的组数。</span><br><span class="line"></span><br><span class="line">接下来按照如下格式分别给出T组数据。 </span><br><span class="line"></span><br><span class="line">每组数据的第一行包含一个正整数 n。</span><br><span class="line"></span><br><span class="line">接下来一行包含 n 个由空格隔开的正整数 a[i]。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出文件共有T行，对于每组数据，输出一行一个正整数，表示所有与 (n,a) 等价的货币系统 (m,b) 中，最小的 m。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">1 ≤ n ≤ 100,</span><br><span class="line">1 ≤ a[i] ≤ 25000,</span><br><span class="line">1 ≤ T ≤ 20</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a[1..n] b[1..m]</span><br><span class="line">(n,a) &#x3D; (m,b)</span><br><span class="line">b[1..m] 在 a[1..n] 中 且不会在之外 </span><br><span class="line">a[1..n] &#x3D; &#123;1 ,2 ,3&#125; b[1..m] &#x3D; &#123;1 ,2 ,3&#125;</span><br><span class="line">a[1..n] &#x3D; &#123;1 ,2 ,3 ,4 ,6 ,13&#125; b[1..m] &#x3D; &#123;1 ,2 ,3&#125;</span><br><span class="line">因为 选 13 的话 2 ，3 仍然要选 且不能选 5 多余了</span><br><span class="line"></span><br><span class="line">f[i][j] 前 i 个数能组成 j 或者 是否可以组成 j </span><br><span class="line">如果能用前 i - 1 个数组成 第 i 个数 那么就是 第 i 个数没必要选择</span><br><span class="line">如果不能选择的话 那么必须选择 答案加一</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>, M = <span class="number">25010</span>;</span><br><span class="line">LL v1[N];</span><br><span class="line">LL f[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    LL m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v1[i];</span><br><span class="line">    sort(v1 + <span class="number">1</span>, v1 + n + <span class="number">1</span>);</span><br><span class="line">    m = v1[n];</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!f[v1[i]]) res++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = v1[i]; j &lt;= m; ++j) &#123;</span><br><span class="line">            f[j] += f[j - v1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="多重背包问题"><a href="#多重背包问题" class="headerlink" title="多重背包问题"></a>多重背包问题</h5><h6 id="多重背包问题-I"><a href="#多重背包问题-I" class="headerlink" title="多重背包问题 I"></a>多重背包问题 I</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">有 N 种物品和一个容量是 V 的背包。</span><br><span class="line"></span><br><span class="line">第 i 种物品最多有 si 件，每件体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品体积总和不超过背包容量，且价值总和最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品种数和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行三个整数 vi,wi,si，用空格隔开，分别表示第 i 种物品的体积、价值和数量。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 100</span><br><span class="line">0 &lt; vi,wi,si ≤ 100</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>, V = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> v1[N], s[N], w[N];</span><br><span class="line"><span class="keyword">int</span> f[N][V];</span><br><span class="line"><span class="keyword">int</span> n, v;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v1[i] &gt;&gt; w[i] &gt;&gt; s[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= v; ++j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= s[i]; ++k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= v1[i] * k) &#123;</span><br><span class="line">                    f[i][j] = <span class="built_in">max</span>(f[i][j], f[i - <span class="number">1</span>][j - v1[i] * k] + w[i] * k);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[n][v];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="多重背包问题-II"><a href="#多重背包问题-II" class="headerlink" title="多重背包问题 II"></a>多重背包问题 II</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">有 N 种物品和一个容量是 V 的背包。</span><br><span class="line"></span><br><span class="line">第 i 种物品最多有 si 件，每件体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品体积总和不超过背包容量，且价值总和最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品种数和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行三个整数 vi,wi,si，用空格隔开，分别表示第 i 种物品的体积、价值和数量。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N ≤ 1000</span><br><span class="line">0 &lt; V ≤ 2000</span><br><span class="line">0 &lt; vi,wi,si ≤ 2000</span><br><span class="line">提示：</span><br><span class="line">本题考查多重背包的二进制优化方法。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span> * <span class="number">12</span>, V = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> v1[N], s[N], w[N];</span><br><span class="line"><span class="keyword">int</span> f[N][V];</span><br><span class="line"><span class="keyword">int</span> ff[V];</span><br><span class="line"><span class="keyword">int</span> n, m, vt, wt, st;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; vt &gt;&gt; wt &gt;&gt; st;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (k &lt;= st) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            w[cnt] = wt * k;</span><br><span class="line">            v1[cnt] = vt * k;</span><br><span class="line">            st -= k;</span><br><span class="line">            k *= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            w[cnt] = wt * st;</span><br><span class="line">            v1[cnt] = vt * st;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    n = cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v1[i]; --j) &#123;</span><br><span class="line">            ff[j] = <span class="built_in">max</span>(ff[j], ff[j - v1[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ff[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">将个数分成 log k 组 </span><br><span class="line">1 2 4 8 ... 能组成0 - k 每个</span><br><span class="line">然后 转换成01背包问题</span><br><span class="line">log10(2000) &#x2F;log10(2) &#x3D; log2(2000) &#x3D; 10.9658</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dp[i][j] &#x3D; max(dp[i -1][j] , dp[i - 1][j -v[i]] + w[i] , dp[i-1][j -2 * v[i]] + 2 * w[i] ..</span><br><span class="line">						dp[i - 1][j - s[i] * v[i]] + s[i] * w[i])</span><br><span class="line">dp[i - v[i]][j] &#x3D; max(        dp[i - 1][j -v[i]]        , dp[i -1][j - 2 * v[i]] + w[i] ...</span><br><span class="line">						dp[i - 1][j - s[i] * v[i]] + (s[i] - 1) *w[i] </span><br><span class="line">           ,dp[i - 1][j - (s[i] + 1) * v[i]] + s[i] * w[i])</span><br><span class="line">有上限所以dp[i - v[i]][j] 比dp[i -v[i]][j] 可能多一个 不好使用</span><br></pre></td></tr></table></figure>
<h6 id="多重背包问题-III"><a href="#多重背包问题-III" class="headerlink" title="多重背包问题 III"></a>多重背包问题 III</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">有 N 种物品和一个容量是 V 的背包。</span><br><span class="line"></span><br><span class="line">第 i 种物品最多有 si 件，每件体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品体积总和不超过背包容量，且价值总和最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V (0&lt;N≤1000, 0&lt;V≤20000)，用空格隔开，分别表示物品种数和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行三个整数 vi,wi,si，用空格隔开，分别表示第 i 种物品的体积、价值和数量。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N ≤ 1000</span><br><span class="line">0 &lt; V ≤ 20000</span><br><span class="line">0 &lt; vi,wi,si ≤ 20000</span><br><span class="line">提示</span><br><span class="line">本题考查多重背包的单调队列优化方法。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">20010</span>;</span><br><span class="line"><span class="keyword">int</span> f[V], v[N], s[N], w[N], g[V], q[V];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; s[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(g, f, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; v[i]; ++j) &#123;</span><br><span class="line">            <span class="keyword">int</span> hh = <span class="number">0</span>, tt = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt;= m; k += v[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (hh &lt;= tt &amp;&amp; q[hh] &lt; k - s[i] * v[i]) hh++;</span><br><span class="line">                <span class="keyword">if</span> (hh &lt;= tt) f[k] = <span class="built_in">max</span>(f[k], g[q[hh]] + (k - q[hh]) / v[i] * w[i]);</span><br><span class="line">                <span class="keyword">while</span> (hh &lt;= tt &amp;&amp; g[q[tt]] - (q[tt] - j) / v[i] * w[i] &lt;= g[k] - (k - j) / v[i] * w[i]) tt--;</span><br><span class="line">                q[++tt] = k;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">f[j] &#x3D; g[j],  	g[j - v[i]] + w[i], 		g[j - 2 * v[i]] + 2 * w[i]</span><br><span class="line">...</span><br><span class="line">g[j - s[i] * v[i]] + s[i] * w[i]</span><br><span class="line">-----------------------------------------------------------------------------------------------</span><br><span class="line">f[j - v[i]] &#x3D;  	g[j - v[i]]     , 			g[j - 2 * v[i]] + w[i]</span><br><span class="line">...</span><br><span class="line">g[j - s[i] * v[i]] + (s[i] - 1) * w[i], g[j - (s[i] + 1) * v[i]] + s[i] * w[i]</span><br><span class="line">-----------------------------------------------------------------------------------------------</span><br><span class="line">f[j - 2 * v[i]] &#x3D; 											g[j - 2 * v[i]]</span><br><span class="line">...</span><br><span class="line">g[j - s[i] * v[i]] + (s[i] - 2) * w[i], g[j - (s[i] + 1) * v[i]] + (s[i] - 1) * w[i],</span><br><span class="line">g[j - (s[i] + 2) * v[i]] + s[i] * w[i]</span><br><span class="line">-----------------------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">g[j] &#x3D; f[i - 1][j]  f[j] &#x3D; f[i - 1][j]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">完全背包问题 是 f[i][j] 等于 f[i - 1][j - k * v[i]] + k * w[i] -- f[i - 1][j]</span><br><span class="line">j - k * v[i] 是大于等于 0 最小的</span><br><span class="line">但是多重背包 有个数限制 导致不能多选 如果 f[i][j - v[i]] 已经把全部的s[i] 选完</span><br><span class="line">f[i][j] &#x3D; max(f[i - 1][j], f[i - v[i]][j] + w[i]) 如果是后者大的话 那么就会再选一次 第i个物品 错误</span><br><span class="line">那么就是</span><br><span class="line"></span><br><span class="line">r		r + v		r + 2v	r + 3v	k - v		k</span><br><span class="line"></span><br><span class="line">j 只能至多向前选择 s[i]个 单调队列解决</span><br><span class="line">r r + v ....这些数 只和 r 有关 </span><br><span class="line">根据朴素做法 f[i][j] &#x3D; max(f[i][j], f[i - 1][j - v1[i] * k] + w[i] * k); k &lt;&#x3D; s[i]</span><br><span class="line">v &#x3D; 2 m &#x3D; 100 那么 f[j] &#x3D; &#123;f[j] , f[j - 2] + w , f[j - 4]...&#125;</span><br><span class="line">这些数 j &#x3D; 100 , &#123;100, 98, 96...&#125;</span><br><span class="line">			j &#x3D; 101 , &#123;101, 99, 97...&#125;</span><br><span class="line">每一组余v都是相等的 且只有这些数是有关联的</span><br><span class="line">所以根据 0 - v[i] - 1 分组 每个 j 向组前的s[i] 找最大值 </span><br><span class="line"></span><br><span class="line">f[r + v] &#x3D; &#123;.. g[r] + w..&#125;</span><br><span class="line">f[r + 2v] &#x3D; &#123;.. g[r] + 2w ..&#125;</span><br><span class="line">因为 r 这个点 相对 r + v 和 r + 2v 加上w[i] 个数是不同的 且r越小 加的w[i] 越多 </span><br><span class="line">	所以加入单调队列时候要将每个数的偏移量加上去</span><br><span class="line">                                                                           </span><br><span class="line">j - 5v,  j - 4v, j - 3v, j - 2v, j - v, 	j</span><br><span class="line">+ 5w			+4w 		+3w			+2w			+w		+0  	原本是加</span><br><span class="line">-0				-w			-2w			-3w			-4w		-5w		减去偏移量</span><br><span class="line"></span><br><span class="line">对于j - 3v 来说 j - 5v 和 j - 4v 一个要加 2w 一个 w</span><br><span class="line">对于j - 2v 来说 j - 5v 和 j - 4v 一个要加 3w 一个 2w</span><br><span class="line"></span><br><span class="line">设 j - 5v  &#x3D; 10 ， j - 4v &#x3D; 2   w &#x3D; 1</span><br><span class="line">j - 3v  12 , 5</span><br><span class="line">j - 2v  13 , 6</span><br><span class="line"></span><br><span class="line">对于单调队列只是为了比较大小 而不是为了直接得到答案</span><br><span class="line">如果一组数都是 0 要加上等差数列 递减 </span><br><span class="line">知道原来的到现在要加的大小</span><br><span class="line">0		0   0  0    0 	原来的</span><br><span class="line">5w	4w 3w  2w   w  现在的</span><br><span class="line">0  -w -2w -3w -4w 偏差</span><br><span class="line">                                                                           </span><br><span class="line">0  2    5 		 3 		  0 	原来的      0   2  5    3   0</span><br><span class="line">5w 2+4w 5+3w   3+2w   0+w  现在的     15  14 14   9   3</span><br><span class="line">0  2-w  5-2w   3-3w   0-4w 偏差				0  -1 -1  -6 -12</span><br><span class="line"></span><br><span class="line">对于 3 来说 要找到前三个每个加一个规定的数最大的 就是 0 + 5w.2 + 4w.3 + 3w</span><br><span class="line">对于 0 来说 要找到前三个每个加一个规定的数最大的 就是 0 + 4w.2 + 3w.3 + 2w</span><br><span class="line">已经知道他们的分别要加的数</span><br><span class="line">那么</span><br><span class="line">对于 3 来说 就是找  0 - w.2 - 2w.3 - 3w 最大的数 </span><br><span class="line">对于 0 来说 就是找  0 - w.2 - 2w.3 - 3w 最大的数</span><br><span class="line">然后原数加上要加的数</span><br><span class="line">实质就是本来 之后的结果全部减去一个 nw 最大值不变</span><br></pre></td></tr></table></figure>
<h6 id="庆功会"><a href="#庆功会" class="headerlink" title="庆功会"></a>庆功会</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">为了庆贺班级在校运动会上取得全校第一名成绩，班主任决定开一场庆功会，为此拨款购买奖品犒劳运动员。</span><br><span class="line"></span><br><span class="line">期望拨款金额能购买最大价值的奖品，可以补充他们的精力和体力。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行二个数n，m，其中n代表希望购买的奖品的种数，m表示拨款金额。</span><br><span class="line"></span><br><span class="line">接下来n行，每行3个数，v、w、s，分别表示第I种奖品的价格、价值（价格与价值是不同的概念）和能购买的最大数量（买0件到s件均可）。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">一行：一个数，表示此次购买能获得的最大的价值（注意！不是价格）。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">n ≤ 500,m ≤ 6000,</span><br><span class="line">v ≤ 100,w ≤ 1000,s ≤ 10</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">510</span> * <span class="number">4</span>, M = <span class="number">6010</span>;</span><br><span class="line"><span class="keyword">int</span> f[M], n, m, v[N], w[N], vt, wt, st, cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; vt &gt;&gt; wt &gt;&gt; st;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (k &lt;= st) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            v[cnt] = k * vt;</span><br><span class="line">            w[cnt] = k * wt;</span><br><span class="line">            st -= k;</span><br><span class="line">            k *= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            v[cnt] = st * vt;</span><br><span class="line">            w[cnt] = st * wt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    n = cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v[i]; --j) &#123;</span><br><span class="line">            f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">朴素做法也是可以的</span><br></pre></td></tr></table></figure>
<h6 id="混合背包问题"><a href="#混合背包问题" class="headerlink" title="混合背包问题"></a>混合背包问题</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">有 N 种物品和一个容量是 V 的背包。</span><br><span class="line"></span><br><span class="line">物品一共有三类：</span><br><span class="line"></span><br><span class="line">  第一类物品只能用1次（01背包）；</span><br><span class="line">  第二类物品可以用无限次（完全背包）；</span><br><span class="line">  第三类物品最多只能用 si 次（多重背包）；</span><br><span class="line">  每种体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品体积总和不超过背包容量，且价值总和最大。</span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品种数和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行三个整数 vi,wi,si，用空格隔开，分别表示第 i 种物品的体积、价值和数量。</span><br><span class="line"></span><br><span class="line">  si &#x3D; −1 表示第 i 种物品只能用1次；</span><br><span class="line">  si &#x3D; 0 表示第 i 种物品可以用无限次；</span><br><span class="line">  si &gt; 0 表示第 i 种物品可以使用 si 次；</span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span> * <span class="number">10</span>, M = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> f[M], n, m, v[N], w[N], vt, wt, st, cnt;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; vt &gt;&gt; wt &gt;&gt; st;</span><br><span class="line">        <span class="keyword">if</span> (st == <span class="number">-1</span>) &#123;</span><br><span class="line">            ++cnt;</span><br><span class="line">            v[cnt] = vt;</span><br><span class="line">            w[cnt] = wt;</span><br><span class="line">            mp[cnt] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (st == <span class="number">0</span>) &#123;</span><br><span class="line">            ++cnt;</span><br><span class="line">            v[cnt] = vt;</span><br><span class="line">            w[cnt] = wt;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> k = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (k &lt;= st) &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                v[cnt] = vt * k;</span><br><span class="line">                w[cnt] = wt * k;</span><br><span class="line">                st -= <span class="number">2</span>;</span><br><span class="line">                k *= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (st &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                v[cnt] = vt * st;</span><br><span class="line">                w[cnt] = wt * st;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    n = cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mp[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = v[i]; j &gt;= m; ++j) &#123;</span><br><span class="line">                f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v[i]; --j) &#123;</span><br><span class="line">                f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以分别使用朴素做法 也可以将多重转换成01 然后01和完全分别背包</span><br><span class="line">我们只关注第 i 个物品是什么类型 而不用去考虑之前的是什么类型</span><br></pre></td></tr></table></figure>
<h5 id="求方案"><a href="#求方案" class="headerlink" title="求方案"></a>求方案</h5><h6 id="背包问题求具体方案"><a href="#背包问题求具体方案" class="headerlink" title="背包问题求具体方案"></a>背包问题求具体方案</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">有 N 件物品和一个容量是 V 的背包。每件物品只能使用一次。</span><br><span class="line"></span><br><span class="line">第 i 件物品的体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。</span><br><span class="line"></span><br><span class="line">输出 字典序最小的方案。这里的字典序是指：所选物品的编号所构成的序列。物品的编号范围是 1…N。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品数量和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行两个整数 vi,wi，用空格隔开，分别表示第 i 件物品的体积和价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一行，包含若干个用空格隔开的整数，表示最优解中所选物品的编号序列，且该编号序列的字典序最小。</span><br><span class="line"></span><br><span class="line">物品编号范围是 1…N。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 1000</span><br><span class="line">0 &lt; vi,wi ≤ 1000</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> w[N], v[N];</span><br><span class="line"><span class="keyword">int</span> f[N][V];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            f[i][j] = f[i + <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v[i]) &#123;</span><br><span class="line">                f[i][j] = <span class="built_in">max</span>(f[i][j], f[i + <span class="number">1</span>][j - v[i]] + w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> j = m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &gt;= v[i] &amp;&amp; f[i][j] == f[i + <span class="number">1</span>][j - v[i]] + w[i]) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">            j -= v[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">求具体方案一定不能压缩空间，因为要根据方案的选择来判断是否选择</span><br><span class="line">这题要求字典序最小 </span><br><span class="line">	从第一个 如果不能选那么就不能 如果必须选，可选可不选 那么一定也要选 这样字典序最小</span><br><span class="line">但是正常写的话只能从最后一个开始推</span><br><span class="line">所以要将物品从后向前去规划，然后从前向后去反推规划</span><br><span class="line">f[i][j] &#x3D; max(f[i - 1][j],f[i -1][j - v[i]]) </span><br><span class="line">f[i][j] &#x3D; f[i - 1][j] &#x3D; f[i -1][j - v[i]] 就是可选可不选</span><br><span class="line">f[i][j] &#x3D; f[i - 1][j] !&#x3D; f[i -1][j - v[i]]  必须不选</span><br><span class="line">f[i][j] &#x3D; f[i - 1][j - v[i]] !&#x3D; f[i - 1][j] 必须选</span><br></pre></td></tr></table></figure>
<h5 id="分组背包问题"><a href="#分组背包问题" class="headerlink" title="分组背包问题"></a>分组背包问题</h5><h6 id="分组背包问题-1"><a href="#分组背包问题-1" class="headerlink" title="分组背包问题"></a>分组背包问题</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">有 N 组物品和一个容量是 V 的背包。</span><br><span class="line"></span><br><span class="line">每组物品有若干个，同一组内的物品最多只能选一个。</span><br><span class="line">每件物品的体积是 v[i][j]，价值是 w[i][j]，其中 i 是组号，j 是组内编号。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使物品总体积不超过背包容量，且总价值最大。</span><br><span class="line"></span><br><span class="line">输出最大价值。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行有两个整数 N，V，用空格隔开，分别表示物品组数和背包容量。</span><br><span class="line"></span><br><span class="line">接下来有 N 组数据：</span><br><span class="line"></span><br><span class="line">每组数据第一行有一个整数 S[i]，表示第 i 个物品组的物品数量；</span><br><span class="line">每组数据接下来有 S[i] 行，每行有两个整数 v[i][j],w[i][j]，用空格隔开，分别表示第 i 个物品组的第 j 个物品的体积和价值；</span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示最大价值。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 100</span><br><span class="line">0 &lt; S[i] ≤ 100</span><br><span class="line">0 &lt; v[i][j],w[i][j] ≤100</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>, V = <span class="number">110</span>, S = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> f[V], av[N][S], aw[N][S], as[N];</span><br><span class="line"><span class="keyword">int</span> n, m, p, v, w;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; as[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; as[i]; ++j) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; av[i][j] &gt;&gt; aw[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= as[i]; ++k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= av[i][k])</span><br><span class="line">                    f[j] = <span class="built_in">max</span>(f[j], f[j - av[i][k]] + aw[i][k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="机器分配-分组背包-具体方案"><a href="#机器分配-分组背包-具体方案" class="headerlink" title="机器分配(分组背包+具体方案)"></a>机器分配(分组背包+具体方案)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">总公司拥有M台 相同 的高效设备，准备分给下属的N个分公司。</span><br><span class="line"></span><br><span class="line">各分公司若获得这些设备，可以为国家提供一定的盈利。盈利与分配的设备数量有关。</span><br><span class="line"></span><br><span class="line">问：如何分配这M台设备才能使国家得到的盈利最大？</span><br><span class="line"></span><br><span class="line">求出最大盈利值。</span><br><span class="line"></span><br><span class="line">分配原则：每个公司有权获得任意数目的设备，但总台数不超过设备数M。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行有两个数，第一个数是分公司数N，第二个数是设备台数M；</span><br><span class="line"></span><br><span class="line">接下来是一个N*M的矩阵，矩阵中的第 i 行第 j 列的整数表示第 i 个公司分配 j 台机器时的盈利。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">第一行输出最大盈利值；</span><br><span class="line"></span><br><span class="line">接下N行，每行有2个数，即分公司编号和该分公司获得设备台数。</span><br><span class="line"></span><br><span class="line">答案不唯一，输入任意合法方案即可。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">1 ≤ N ≤ 10,</span><br><span class="line">1 ≤ M ≤ 15</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">15</span>, M = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> arr[N][M];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> f[N][M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; arr[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= m; ++k) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= k) &#123;</span><br><span class="line">                    f[i][j] = <span class="built_in">max</span>(f[i][j], f[i - <span class="number">1</span>][j - k] + arr[i][k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[n][m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> j = m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= j; ++k) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i][j] == f[i - <span class="number">1</span>][j - k] + arr[i][k]) &#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">' '</span> &lt;&lt; k &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                j -= k;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="背包问题求方案数"><a href="#背包问题求方案数" class="headerlink" title="背包问题求方案数"></a>背包问题求方案数</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">有 N 件物品和一个容量是 V 的背包。每件物品只能使用一次。</span><br><span class="line"></span><br><span class="line">第 i 件物品的体积是 vi，价值是 wi。</span><br><span class="line"></span><br><span class="line">求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。</span><br><span class="line"></span><br><span class="line">输出 最优选法的方案数。注意答案可能很大，请输出答案模 109+7 的结果。</span><br><span class="line"></span><br><span class="line">输入格式</span><br><span class="line">第一行两个整数，N，V，用空格隔开，分别表示物品数量和背包容积。</span><br><span class="line"></span><br><span class="line">接下来有 N 行，每行两个整数 vi,wi，用空格隔开，分别表示第 i 件物品的体积和价值。</span><br><span class="line"></span><br><span class="line">输出格式</span><br><span class="line">输出一个整数，表示 方案数 模 109+7 的结果。</span><br><span class="line"></span><br><span class="line">数据范围</span><br><span class="line">0 &lt; N,V ≤ 1000</span><br><span class="line">0 &lt; vi,wi ≤ 1000</span><br></pre></td></tr></table></figure>
<p>做法一 :</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">1010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> f[N][V], g[N][V];</span><br><span class="line"><span class="keyword">int</span> n, m, v, w;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; f[i][j] &lt;&lt; <span class="string">'\t'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; g[i][j] &lt;&lt; <span class="string">'\t'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) g[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j];</span><br><span class="line">            g[i][j] = g[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= v) &#123;</span><br><span class="line">                <span class="keyword">if</span> (f[i - <span class="number">1</span>][j] == f[i - <span class="number">1</span>][j - v] + w) &#123;</span><br><span class="line">                    g[i][j] = (g[i - <span class="number">1</span>][j] + g[i - <span class="number">1</span>][j - v]) % mod;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f[i - <span class="number">1</span>][j] &lt; f[i - <span class="number">1</span>][j - v] + w) &#123;</span><br><span class="line">                    f[i][j] = f[i - <span class="number">1</span>][j - v] + w;</span><br><span class="line">                    g[i][j] = g[i - <span class="number">1</span>][j - v];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    out();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; g[n][m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">1010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> f[V], g[V];</span><br><span class="line"><span class="keyword">int</span> n, m, v, w;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) g[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v; --j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[j] == f[j - v] + w) &#123;</span><br><span class="line">                g[j] = (g[j] + g[j - v]) % mod;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f[j] &lt; f[j - v] + w) &#123;</span><br><span class="line">                f[j] = f[j - v] + w;</span><br><span class="line">                g[j] = g[j - v];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; g[m] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">f[i][j] 前 i 个物品体积不超过 j 的最大价值 </span><br><span class="line">2 10</span><br><span class="line">1 2</span><br><span class="line">2 2</span><br><span class="line"></span><br><span class="line">0	2	2	2	2	2	2	2	2	2	2	</span><br><span class="line">0	2	2	4	4	4	4	4	4	4	4	</span><br><span class="line"></span><br><span class="line">1	1	1	1	1	1	1	1	1	1	1	</span><br><span class="line">1	1	2	1	1	1	1	1	1	1	1	</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">----------------------</span><br><span class="line">2 10</span><br><span class="line">1 2</span><br><span class="line">1 2</span><br><span class="line"></span><br><span class="line">0	2	2	2	2	2	2	2	2	2	2	</span><br><span class="line">0	2	4	4	4	4	4	4	4	4	4	</span><br><span class="line"></span><br><span class="line">1	1	1	1	1	1	1	1	1	1	1	</span><br><span class="line">1	2	1	1	1	1	1	1	1	1	1	</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g[i][j] 前 i 个物品最大价值的路径 只看 g[i - 1][j]  和 g[i - 1][j - v[i]]</span><br></pre></td></tr></table></figure>
<p>做法二 :</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>, V = <span class="number">1010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> f[V], g[V];</span><br><span class="line"><span class="keyword">int</span> n, m, v, w;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= v; --j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[j - v] + w &gt; f[j]) &#123;</span><br><span class="line">                f[j] = f[j - v] + w;</span><br><span class="line">                g[j] = g[j - v];</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f[j - v] + w == f[j]) &#123;</span><br><span class="line">                g[j] = (g[j] + g[j - v]) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mx = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (f[i] == mx) &#123;</span><br><span class="line">            sum = (sum + g[i]) % mod;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f[i] &gt; mx) &#123;</span><br><span class="line">            mx = f[i];</span><br><span class="line">            sum = g[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">更容易理解 f[i][j] 就是体积恰好是 j 的最大价值 </span><br><span class="line">然后去遍历找到最大值 遍历找到全部结果</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/13/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" data-id="ck6kcke0z000lakdp2za73027" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-组合数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/" class="article-date">
  <time datetime="2020-02-10T07:31:29.000Z" itemprop="datePublished">2020-02-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/">组合数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>$O(n^2)$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">2010</span>, mod = <span class="number">1000000007</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> c[][] = <span class="keyword">new</span> <span class="keyword">int</span>[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j == <span class="number">0</span>) c[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> c[i][j] = (c[i - <span class="number">1</span>][j] + c[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从 $i$ 个数中选取 $j$个 </p>
<ul>
<li>选第$i$个数 从前$i-1$ 个中选取$j-1$个数</li>
<li>不选第$i$ 个数 从前$i-1$个中选取$j$个数</li>
</ul>
<hr>
<p>$O(nlog(mod))$</p>
<script type="math/tex; mode=display">
\mathsf{C}_a^b = \frac{a!}{b!(a-b)!}</script><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">100010</span>, mod = <span class="number">1000000007</span>;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">int</span>[] fact = <span class="keyword">new</span> <span class="keyword">int</span>[N], infact = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       fact[<span class="number">0</span>] = infact[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">           fact[i] = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) fact[i - <span class="number">1</span>] * i % mod);</span><br><span class="line">           infact[i] = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) infact[i - <span class="number">1</span>] * qmi(i, mod - <span class="number">2</span>, mod) % mod);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">       <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">               res = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) res * a % p);</span><br><span class="line">           &#125;</span><br><span class="line">           b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">           a = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) a * a % p);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> res;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line"> <span class="comment">// 求组合数  </span></span><br><span class="line">System.out.println((<span class="keyword">long</span>) fact[a] * infact[b] % mod * infact[a - b] % mod);</span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
\frac{a}{b} \mod p \neq \frac{a \mod p}{ b \mod p}</script><script type="math/tex; mode=display">
a * b \mod p = (a \mod p) (b \mod p )</script><hr>
<p>卢卡斯定理 适合 $p$改变</p>
<script type="math/tex; mode=display">
\mathsf{C}_a^b \equiv \mathsf{C}_{a/p}^{b/p} \mathsf{C}_{a \mod p}^{b \mod p } (\mod p)</script><p>只有$a &lt; p $并且 $b &lt; p$ 才可以调用函数$\mathsf{C}$</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> <span class="title">qmi</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            res = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) res * a % p);</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) a * a % p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">lucas</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; p &amp;&amp; b &lt; p) <span class="keyword">return</span> C(a, b, p);</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>) ((<span class="keyword">long</span>) lucas(a / p, b / p, p) * C(a % p, b % p, p) % p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b &gt; a) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> i = <span class="number">1</span>, j = a; i &lt;= b; ++i, --j) &#123;</span><br><span class="line">        res = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) res * j % p);</span><br><span class="line">        res = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) res * qmi(i, p - <span class="number">2</span>, p) % p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>卡特兰数</p>
<p><img src="/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/Catalan.jpeg" alt="Catalan1"><br><img src="/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/Catalan2.png" alt="Catalan2"></p>
<script type="math/tex; mode=display">
\mathsf{C}_{2n}^{n} - \mathsf{C}_{2n}^{n-1} = \frac{\mathsf{C}_{2n}^{n}}{n + 1}</script><p>可以直接写 或者函数$\mathsf{C}$ 或者使用Lucas定理或者上面的方法</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/" data-id="ck6kcke0y000iakdpfnwt3lmc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-高斯消元" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/09/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" class="article-date">
  <time datetime="2020-02-09T07:43:45.000Z" itemprop="datePublished">2020-02-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/09/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/">高斯消元</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">double</span>[][] arr = <span class="keyword">new</span> <span class="keyword">double</span>[N][N];</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">                System.out.printf(<span class="string">"%.2f\t"</span>, arr[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">gauss</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> r, c;</span><br><span class="line">        <span class="comment">// r 是未固定行的开始</span></span><br><span class="line">        <span class="comment">// c 是这一行的列值 非零的开始</span></span><br><span class="line">        <span class="keyword">for</span> (r = <span class="number">0</span>, c = <span class="number">0</span>; c &lt; n; ++c) &#123;</span><br><span class="line">            <span class="comment">// 找当前列 c 的最大值</span></span><br><span class="line">            <span class="keyword">int</span> t = r;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Math.abs(arr[i][c]) &gt; Math.abs(arr[t][c])) &#123;</span><br><span class="line">                    t = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (Math.abs(arr[t][c]) &lt; eps) <span class="keyword">continue</span>; <span class="comment">// 未固定的全部行 这一列都是零</span></span><br><span class="line">            <span class="comment">// 将找出的列放到已固定的下一行</span></span><br><span class="line">            <span class="keyword">if</span> (t != r) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = c; i &lt;= n; ++i) &#123;</span><br><span class="line">                    <span class="keyword">double</span> temp = arr[t][i];</span><br><span class="line">                    arr[t][i] = arr[r][i];</span><br><span class="line">                    arr[r][i] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将找出的行 当前列 改为 1</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= c; --i) arr[r][i] /= arr[r][c];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将未固定 且不是 选定的行 当前 列 置零</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = r + <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Math.abs(arr[i][c]) &lt; eps) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt;= c; --j) &#123;</span><br><span class="line">                    arr[i][j] -= arr[r][j] * arr[i][c]; <span class="comment">// arr[r][c] = 1 arr[i][c] -= arr[i][c] * 1 倍数 就是arr[i][c]</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//            out();</span></span><br><span class="line">            r++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (r &lt; n) &#123;</span><br><span class="line">            <span class="comment">// 代表 r 开始下面行全部都是零 如果 等式右边不是零 就是无解 否则无穷解</span></span><br><span class="line">            <span class="comment">// 1 x y ..</span></span><br><span class="line">            <span class="comment">// 0 0 a ..</span></span><br><span class="line">            <span class="comment">// 0 0 0 .. ?</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Math.abs(arr[i][n]) &gt; eps) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 使 第 i 行 第 i 列 为 1</span></span><br><span class="line">        <span class="comment">// 最后只要arr[i][n] 的值</span></span><br><span class="line">        <span class="comment">// 从下向上 保证 第 i 行 第 i 列 为 1</span></span><br><span class="line">        <span class="comment">// 这一行 后面的数通过下面的 一们操作为零</span></span><br><span class="line">        <span class="comment">// 1    0.5   -1.5    -4.5</span></span><br><span class="line">        <span class="comment">// 0     1      0      -2</span></span><br><span class="line">        <span class="comment">// 0     0      1       3</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j) &#123;</span><br><span class="line">                arr[i][n] -= arr[j][n] * arr[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/09/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/" data-id="ck6kcke10000oakdpff4udfwo" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-中国剩余定理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/08/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" class="article-date">
  <time datetime="2020-02-08T04:23:06.000Z" itemprop="datePublished">2020-02-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/08/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/">中国剩余定理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <script type="math/tex; mode=display">
\begin{cases}
x \equiv a_1(\mod m_1)\\
x \equiv a_2(\mod m_2)\\
...\\
x \equiv a_n(\mod m_n)\\
\end{cases}</script><p>$m_1 , m_2 …m_n$ <strong>两两互质</strong></p>
<p>$M = m_1m_2m_3…m_n$</p>
<p>$M_1 = m_2m_3…m_n$</p>
<p>$M_2 = m_1m_3…m_n$</p>
<p>$M_i = \frac{M}{m_i},m_i = \frac{M}{M_i}$ 并且$M_i$和$m_i$互质，所以$M_i$有逆 </p>
<p>设$M_i ^{-1}$ 表示 $M_i$ 模 $m_i$ 的逆</p>
<p>$x = a_1M_1M_1^{-1} + a_2M_2M_2^{-1}…a_nM_nM_n^{-1}$</p>
<p>因为$M_1M_1^{-1} \mod  m_1 = 1,$ $M_iM_i^{-1} \mod m_1 = 0$ ,i !=1</p>
<p>$M_2M_2^{-1} \mod  m_2 = 1$ $,M_iM_i^{-1} \mod m_2 = 0 $,i != 2</p>
<p>同理可得 $x$ 是一个解</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/08/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/" data-id="ck6kcke0q0004akdp7ko9dz1i" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-拓展欧几里得算法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/03/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/" class="article-date">
  <time datetime="2020-02-03T06:10:35.000Z" itemprop="datePublished">2020-02-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/03/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/">拓展欧几里得算法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="裴蜀定理"><a href="#裴蜀定理" class="headerlink" title="裴蜀定理"></a>裴蜀定理</h5><blockquote>
<p>对于任意正整数 <script type="math/tex">a</script>, <script type="math/tex">b</script> ,一定存在非零整数 <script type="math/tex">x</script> , <script type="math/tex">y</script> ,使得 <script type="math/tex">ax + by = gcd(a , b)</script>  </p>
<p>并且 <script type="math/tex">gcd(a,b)</script> 是 <script type="math/tex">a</script> ,  <script type="math/tex">b</script>  能凑出的最小正整数</p>
</blockquote>
<h5 id="拓展欧几里得算法"><a href="#拓展欧几里得算法" class="headerlink" title="拓展欧几里得算法"></a>拓展欧几里得算法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">exGcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> d = exGcd(b, a % b);</span><br><span class="line">    <span class="keyword">int</span> t = x;</span><br><span class="line">    x = y;</span><br><span class="line">    y = t - (a / b) * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="边界情况"><a href="#边界情况" class="headerlink" title="边界情况"></a>边界情况</h6><p>当$x \star a + y \star b = gcd(a,b) = a $  此时 $b = 0 , gcd(a,b) = a$</p>
<p>所以$x = 1 , y = 0 ，x = 1$是一定 $y=0$ 是规定 </p>
<h6 id="一般情况"><a href="#一般情况" class="headerlink" title="一般情况"></a>一般情况</h6><p>$x_1 \star a + y_1 \star b = x_2 \star b + y_2 \star (a \mod b)$</p>
<p>$ a \mod b = a - \lfloor {\frac ab} \rfloor $</p>
<p>$ x_1 \star a  + y_1 \star b = x_2 \star b + y_2 \star(a - \lfloor{\frac a b}\rfloor) \star b = y_2 \star a + (x_2 -\lfloor{\frac ab}\rfloor \star y_2) \star b $</p>
<p>$x_2,y_2$是上一层递归求的 $x_1,y_1$是这一层要求的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> t = x;</span><br><span class="line">x = y;</span><br><span class="line">y = t - (a/b) * x;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exGcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> d = exGcd(b, a % b, y, x);</span><br><span class="line">    y -= (a / b) * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$x_2 = y ,y_2 = x$</p>
<p>$x \star a + y \star b = x \star a + (y - \lfloor{\frac ab}\rfloor \star x) \star b$</p>
<hr>
<h5 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h5><p><a herf="https://www.acwing.com/problem/content/880/">线性同余方程</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> n = in.nextInt();</span><br><span class="line">        <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> a = in.nextInt(), b = in.nextInt(), m = in.nextInt();</span><br><span class="line">            <span class="keyword">int</span> d = exgcd(a, m);</span><br><span class="line">            <span class="keyword">if</span> (b % d != <span class="number">0</span>) System.out.println(<span class="string">"impossible"</span>);</span><br><span class="line">            <span class="keyword">else</span> System.out.println((<span class="keyword">long</span>) x * (b / d) % m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">            x = <span class="number">1</span>;</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> d = exgcd(b, a % b);</span><br><span class="line">        <span class="keyword">int</span> t = x;</span><br><span class="line">        x = y;</span><br><span class="line">        y = t - (a / b) * x;</span><br><span class="line">        <span class="keyword">return</span> d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$a \star x \equiv b (\mod m)$</p>
<p>$ax + km = b$</p>
<p>$b$ 要求是$gcd(a,m)$的倍数 那么就存在解</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/03/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/" data-id="ck6kcke0v000aakdp63ju22wl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-快速幂" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/03/%E5%BF%AB%E9%80%9F%E5%B9%82/" class="article-date">
  <time datetime="2020-02-03T04:32:48.000Z" itemprop="datePublished">2020-02-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/03/%E5%BF%AB%E9%80%9F%E5%B9%82/">快速幂</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            res = (<span class="keyword">int</span>) (((<span class="keyword">long</span>)res * a) % p);</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = (<span class="keyword">int</span>) (((<span class="keyword">long</span>)a * a) % p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">
a = x_1 *a^{2^0} * x_2 *a^{2^1} ...x_{logb}* a^{2^{logb}}</script><script type="math/tex; mode=display">
a = a^{2^{x1} + 2^{x2}+...}</script><script type="math/tex; mode=display">
(a^{2^0})^2 = a^{2^1} ...</script><p>就是 b 可以 根据 二进制分解 <script type="math/tex">(5)_10 = (101)_2</script></p>
<script type="math/tex; mode=display">5 = 2^0 + 2^2</script><h5 id="快速幂求乘法逆元"><a href="#快速幂求乘法逆元" class="headerlink" title="快速幂求乘法逆元"></a>快速幂求乘法逆元</h5><blockquote>
<p>乘法逆元就是 $ \frac{a}{b} \equiv a \star b^{-1}  (\mod m) $ 即$b^{-1}$ 称作$b$ 模$m$ 的逆元 </p>
<p>$b$ 逆元的充分必要条件是  $b$与 $m$ 互质 当$m$ 为质数的时候 $b^{m-2}$ 就是$b$的逆元</p>
<p>其中 <script type="math/tex">b|a</script>  ，<script type="math/tex">b</script> 与 <script type="math/tex">m</script> 互质</p>
<p>且 <script type="math/tex">m</script>是质数</p>
<p>$ b \star \frac {a} {b} \equiv a \star b^{-1} \star b (\mod m)$</p>
<p>$ a \equiv a * b ^{-1} \star b (\mod m) $</p>
<p>$1 \equiv b^{-1} \star b (\mod m)$</p>
<p>根据 费马小定理 <script type="math/tex">a^{p-1} \equiv 1 (\mod p)</script> p 是质数</p>
<p>所以 <script type="math/tex">b^{-1} = a ^{p-2}</script></p>
<ol>
<li><p><script type="math/tex">a < m</script>  ,a 和 m 一定互质</p>
</li>
<li><p><script type="math/tex">a >= m</script>,a 不是m的倍数 互质</p>
</li>
<li><p>a 是 m 的倍数 那么不存在 乘法逆元 $ a \star x \mod m = 0 $ 但是 <script type="math/tex">\frac{a}{b}  \mod m</script> 不一定等于 <script type="math/tex">0</script></p>
<p>a = 32 m = 4 b = 16  <script type="math/tex">\frac {a} {b} = 2</script> 不存在 $ b ^{ -1 } \star a \mod m  = 2 $</p>
</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">qmi</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a % p == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// 不存在逆元</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((b &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">            res = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) res * a % p); <span class="comment">// 要 % p 再转换 不然还是会溢出</span></span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = (<span class="keyword">int</span>) ((<span class="keyword">long</span>) (a) * a % p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/03/%E5%BF%AB%E9%80%9F%E5%B9%82/" data-id="ck6kcke0s0006akdpb4i67nuc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-欧拉函数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/02/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/" class="article-date">
  <time datetime="2020-02-02T13:00:07.000Z" itemprop="datePublished">2020-02-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/02/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/">欧拉函数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h5><blockquote>
<p> 1 ~  N 中与  N 互质的数的个数被称为欧拉函数，记为 $ \Phi(N) $。<br> 若在算数基本定理中，$N=p^{a1}_1p^{a2}_2…p^{am}_m $，则：<br> $ \Phi(N)= N∗ \frac {p_1−1 }{p_1} ∗ \frac {p_2−1}{p_2}∗…∗\frac{p_m−1}{p_m} $<br> 即 $\Phi(N)= N∗ (1 -\frac {1}{p_1}) ∗ (1 - \frac {1}{p_2} )∗…∗ (1 - \frac{1}{p_m}) $</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">            res = res / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">                x /= i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) res = res / x * (x - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>线性筛求欧拉函数</p>
<p>O(n) 时间复杂度 求出 1 - n 所有数的 欧拉函数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] primes = <span class="keyword">new</span> <span class="keyword">int</span>[N], euler = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">boolean</span>[] st = <span class="keyword">new</span> <span class="keyword">boolean</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_eulers</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    euler[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) &#123;</span><br><span class="line">            primes[cnt++] = i;</span><br><span class="line">            euler[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; ++j) &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                euler[i * primes[j]] = euler[i] * primes[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            euler[i * primes[j]] = euler[i] * (primes[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>$1$ 的欧拉函数 人为规定为 $1$</p>
</li>
<li><p>质数 $x$ 的欧拉函数 为 $x - 1$</p>
</li>
<li><p>$prime[j] \star i$ </p>
<ul>
<li>$== 0$ <ul>
<li>$i % prime[j] == 0$ 说明 $prime[j]$ 是$ i $ 的一个 质因子 </li>
<li>$f(i) = i \star (1 - \frac{1}{p_1}) \star (1 - \frac{1}{p_2})…(1 - \frac{1}{p_k})$</li>
<li>$f(i \star prime[j]) = i \star prime[j] \star  (1 - \frac{1}{p_1}) \star(1 - \frac{1}{p_2})…(1 - \frac{1}{p_k})$</li>
</ul>
</li>
<li>$ != 0 $ <ul>
<li>$f(i) = i \star (1 - \frac{1}{p_1}) \star(1 - \frac{1}{p_2})…(1 - \frac{1}{p_k})$</li>
<li>$f(i \star prime[j]) = i \star prime[j] *  (1 - \frac{1}{p_1}) \star (1 - \frac{1}{p_2})…(1 - \frac{1}{p_k}) \star (1 - \frac{1}{prime[j]})$</li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h5><p>$a ^{\Phi(n)} \equiv 1 (\mod n)$</p>
<p>a  与  n 互质 ( $ gcd(a , n ) = 1 $)</p>
<h6 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h6><p>$x =\{ x_1 ,x_2 … x_{\Phi(n)} \}$<br>$m = \{ a \star x_1 , a \star x_2 … a \star x_{\Phi(n)} \}$</p>
<ol>
<li>m集合中任意两个数 不模 n 同余 （两数%n不相等<ul>
<li>反证法 假设存在$ m_a , m_b $ 模 n 同余</li>
<li>即$m_a \equiv m_b$</li>
<li>$m_a - m_b = n *k$</li>
<li>$a \star x_a - a \star x_b=n\star k$</li>
<li>$a \star (x_a - x_b) = n \star k$</li>
<li>$ a $ 与 $ n $ 互质 </li>
<li>但是 $x_k &lt; n , x_a - x_b &lt; n$</li>
<li>所以假设不成立</li>
</ul>
</li>
<li>m 中的数 % n 全部与 n 互质<ul>
<li>$m_i = a \star a_i$ </li>
<li>$a$ 与$n$ 互质 $x_i$与$n$互质 使用$ m_i$ $与 n $互质</li>
<li>$gcd(a *x_i,n ) = gcd(m_i,n) = gcd(n, n \mod m_i)$</li>
</ul>
</li>
<li>使用 m%n 与 x % n 是一组数  $m_i\mod n = x_j \mod n$</li>
</ol>
<p>当 n 为 质数的时候 费马小定理<br>$<br>a^{p-1} \equiv 1 (\mod p)<br>$</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/02/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0/" data-id="ck6kcke0w000bakdpgvc0bsk1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-基础算法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/02/02/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/" class="article-date">
  <time datetime="2020-02-02T02:57:59.000Z" itemprop="datePublished">2020-02-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/02/02/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/">基础算法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><h5 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quick_sort</span><span class="params">(<span class="keyword">int</span>[] q, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> i = l - <span class="number">1</span>, j = r + <span class="number">1</span>, x = q[(l + r) &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="keyword">do</span> i++; <span class="keyword">while</span> (q[i] &lt; x);</span><br><span class="line">        <span class="keyword">do</span> j--; <span class="keyword">while</span> (q[j] &gt; x);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">            q[i] ^= q[j];</span><br><span class="line">            q[j] ^= q[i];</span><br><span class="line">            q[i] ^= q[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    quick_sort(q, l, j);</span><br><span class="line">    quick_sort(q, j + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>递归处理时选择 <script type="math/tex">(l ,j)</script> 和 <script type="math/tex">( j + 1, r)</script> 一定要和 x 取值 <script type="math/tex">(l +r ) >> 1</script>对应<br>选用 <script type="math/tex">j</script> 时 <script type="math/tex">x</script> 一定不能取<strong>右边界</strong></p>
<script type="math/tex; mode=display">
\{ 1 ,  2 \}   l =  1 , r = 2 ,x = 2 , j = 3 , i = 0</script><script type="math/tex; mode=display">
(1 < 2)  ->  (2 = 2)  ->  (i = 2)</script><script type="math/tex; mode=display">
(2 = 2) -> (j = 2)</script><p>递归调用 <script type="math/tex">(1 , 2)</script> 和 <script type="math/tex">(3 , 2)</script> 而 <script type="math/tex">(1,2 )</script>是一开始调用的会一直递归下去</p>
<hr>
<h5 id="第K个数（不重复"><a href="#第K个数（不重复" class="headerlink" title="第K个数（不重复"></a>第K个数（不重复</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> n, k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getK</span><span class="params">(<span class="keyword">int</span>[] q, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> arr[r];</span><br><span class="line">    <span class="keyword">int</span> i = l - <span class="number">1</span>, j = r + <span class="number">1</span>, x = q[(l + r) &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">        <span class="keyword">do</span> i++; <span class="keyword">while</span> (q[i] &lt; x);</span><br><span class="line">        <span class="keyword">do</span> j--; <span class="keyword">while</span> (q[j] &gt; x);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">            q[i] ^= q[j];</span><br><span class="line">            q[j] ^= q[i];</span><br><span class="line">            q[i] ^= q[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (j &gt;= k) <span class="keyword">return</span> getK(q, l, j);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> getK(q, j + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这种快排的写法 是 左边 小于等于 <script type="math/tex">x</script>  的数 右边是大于等于 <script type="math/tex">x</script>  的数 但是第 <script type="math/tex">j</script> 位不是第<script type="math/tex">k</script> 小的数 没有确定下来</p>
<hr>
<h5 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N], help = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    merge_sort(l, mid);</span><br><span class="line">    merge_sort(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">int</span> i = l, j = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; ++k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &gt; r || (i &lt;= mid &amp;&amp; arr[i] &lt;= arr[j])) help[k] = arr[i++];</span><br><span class="line">        <span class="keyword">else</span> help[k] = arr[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; ++k) &#123;</span><br><span class="line">        arr[k] = help[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="逆序对个数"><a href="#逆序对个数" class="headerlink" title="逆序对个数"></a>逆序对个数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N], help = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    merge_sort(l, mid);</span><br><span class="line">    merge_sort(mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="keyword">int</span> i = l, j = mid + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; ++k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (j &gt; r || (i &lt;= mid &amp;&amp; arr[i] &lt;= arr[j])) help[k] = arr[i++];</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            help[k] = arr[j++];</span><br><span class="line">            ans += mid - i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; ++k) &#123;</span><br><span class="line">        arr[k] = help[k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="二分"><a href="#二分" class="headerlink" title="二分"></a>二分</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (check(mid)) r = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们将区间<script type="math/tex">[l, r]</script>划分成<script type="math/tex">[l, mid]</script>和<script type="math/tex">[mid + 1, r]</script>时，其更新操作是<script type="math/tex">r = mid</script>或者<script type="math/tex">l = mid + 1</script>;，计算<script type="math/tex">mid</script>时不需要加<script type="math/tex">1</script>。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (check(mid)) l = mid;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当我们将区间<script type="math/tex">[l, r]</script>划分成<script type="math/tex">[l, mid - 1]</script>和<script type="math/tex">[mid, r]</script>时，其更新操作是<script type="math/tex">r = mid - 1</script>或者<script type="math/tex">l = mid</script>;，此时为了防止死循环，计算<script type="math/tex">mid</script>时需要加<script type="math/tex">1</script>。</p>
<p><a href="https://www.acwing.com/blog/content/31/" target="_blank" rel="noopener">整数二分</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">search</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (r - l &gt; <span class="number">1e-8</span>) &#123; <span class="comment">// 比题目要求的精度大 2-3</span></span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(check()) r = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">double</span> <span class="title">search</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (check()) r = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>求二次方 要注意$\sqrt{0.01} = 0.1$ 所以 r = max (x , 1)</p>
<p>求三次方 要注意l，r 不能直接等于 -x 和 x 第一和上面一样 第二是 x 可能为负数</p>
<hr>
<h5 id="前缀和"><a href="#前缀和" class="headerlink" title="前缀和"></a>前缀和</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="keyword">int</span> n = in.nextInt();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        arr[i] = in.nextInt();</span><br><span class="line">        arr[i] += arr[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求 a ，b 之间的和</span></span><br><span class="line">    <span class="keyword">int</span> a = in.nextInt(), b = in.nextInt();</span><br><span class="line">    System.out.println(arr[b] - arr[a - <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="二维前缀和"><a href="#二维前缀和" class="headerlink" title="二维前缀和"></a>二维前缀和</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[][] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="keyword">int</span> n = in.nextInt();</span><br><span class="line">    <span class="keyword">int</span> m = in.nextInt();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            arr[i][j] = in.nextInt();</span><br><span class="line">            arr[i][j] += arr[i - <span class="number">1</span>][j] + arr[i][j - <span class="number">1</span>] - arr[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求 ( x1, y1)  和 ( x2, y2) 之间的和 </span></span><br><span class="line">    <span class="keyword">int</span> x1 = in.nextInt(), y1 = in.nextInt(), x2 = in.nextInt(), y2 = in.nextInt();</span><br><span class="line">    System.out.println(</span><br><span class="line">      arr[x2][y2] - arr[x2][y1 - <span class="number">1</span>] - arr[x1 - <span class="number">1</span>][y2] + arr[x1 - <span class="number">1</span>][y1 - <span class="number">1</span>]</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="差分"><a href="#差分" class="headerlink" title="差分"></a>差分</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">100010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="keyword">int</span> n = in.nextInt();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        arr[i] = in.nextInt();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">0</span>; --i) &#123;</span><br><span class="line">        arr[i] -= arr[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// l , r 之间每个数加上 x</span></span><br><span class="line">    <span class="keyword">int</span> l = in.nextInt(), r = in.nextInt(), x = in.nextInt();</span><br><span class="line">    arr[l] += x;</span><br><span class="line">    arr[r + <span class="number">1</span>] -= x;</span><br><span class="line">    <span class="comment">// 前缀和 求操作之后的数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        arr[i] += arr[i - <span class="number">1</span>];</span><br><span class="line">        System.out.print(arr[i] + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="二维差分"><a href="#二维差分" class="headerlink" title="二维差分"></a>二维差分</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[][] arr = <span class="keyword">new</span> <span class="keyword">int</span>[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="keyword">int</span> n = in.nextInt(), m = in.nextInt();</span><br><span class="line">    <span class="keyword">int</span> q = in.nextInt();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = in.nextInt();</span><br><span class="line">            add(i, j, i, j, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q-- != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 对 ( x1 , y1)和( x2 , y2) 之间 加上 x </span></span><br><span class="line">        <span class="keyword">int</span> x1 = in.nextInt(), y1 = in.nextInt(), x2 = in.nextInt(), y2 = in.nextInt(), x = in.nextInt();</span><br><span class="line">        add(x1, y1, x2, y2, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            arr[i][j] += arr[i - <span class="number">1</span>][j] + arr[i][j - <span class="number">1</span>] - arr[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            System.out.print(arr[i][j] + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    arr[x1][y1] += x;</span><br><span class="line">    arr[x2 + <span class="number">1</span>][y1] -= x;</span><br><span class="line">    arr[x1][y2 + <span class="number">1</span>] -= x;</span><br><span class="line">    arr[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没有从构造函数入手，而是从插入的影响入手 ，根据一维差分 和 二维前缀和 性质 对$( x1 , y1)$ 加上 x 会使$ ( x1 , y1)$后面全部的数加上 $x$ </p>
<p>全部的数一开始差分为 $0$ 每次加入一个数 进行一次操作</p>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/02/02/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/" data-id="ck6kcke0j0000akdp98x98w4s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-约数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/30/%E7%BA%A6%E6%95%B0/" class="article-date">
  <time datetime="2020-01-30T12:19:47.000Z" itemprop="datePublished">2020-01-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/30/%E7%BA%A6%E6%95%B0/">约数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="试除法求约数"><a href="#试除法求约数" class="headerlink" title="试除法求约数"></a>试除法求约数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> ArrayList&lt;Integer&gt; arr = <span class="keyword">new</span> ArrayList&lt;&gt;();     </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_divisor</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= x / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">            arr.add(i);</span><br><span class="line">            <span class="keyword">if</span> (i != x / i) arr.add(x / i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    arr.sort((o1,o2)-&gt; o1-o2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h5 id="约数个数"><a href="#约数个数" class="headerlink" title="约数个数"></a>约数个数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_divisor_cnt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">                x /= i;</span><br><span class="line">                cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            hs.put(i, hs.getOrDefault(i, <span class="number">0</span>) + cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) hs.put(x, hs.getOrDefault(x, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 求约数个数</span></span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer value : hs.values()) &#123;</span><br><span class="line">        sum = (sum * (value + <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于一个大于1 的正整数n可以分解质因数：</p>
<script type="math/tex; mode=display">
n = \prod_{i=1}^k p_i^{a_i} = p_1^{a_1} * p_2^{a_2} ... p_k^{a_k}</script><script type="math/tex; mode=display">p_i^{a_i} $$ 的约数有 $$ p_i^0,p_i^1,p_i^2...p_i^{ak}</script><p>约数的个数就是从每个挑选出一些<br>所以n 的正约数个数就是</p>
<script type="math/tex; mode=display">
f(n) = \prod_{i = 1}^k{(a_i + 1)} = (a_1 + 1) * (a_2 + 1)...(a_k + 1)</script><p><a href="https://baike.baidu.com/item/约数个数定理" target="_blank" rel="noopener">约数个数定理</a></p>
<p>int 范围内约数个数最多大概是 1600+ 或者1700+</p>
<hr>
<h5 id="约数之和"><a href="#约数之和" class="headerlink" title="约数之和"></a>约数之和</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_divisor_sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">long</span> MOD = <span class="number">1000000007L</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) &#123;</span><br><span class="line">                x /= i;</span><br><span class="line">                cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            hs.put(i, hs.getOrDefault(i, <span class="number">0</span>) + cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt; <span class="number">1</span>) hs.put(x, hs.getOrDefault(x, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 求约数之和</span></span><br><span class="line">    <span class="keyword">long</span> sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : hs.entrySet()) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = entry.getKey(), a = entry.getValue();</span><br><span class="line">        <span class="keyword">long</span> t = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (a-- != <span class="number">0</span>) &#123;</span><br><span class="line">            t = (t * p + <span class="number">1</span>) % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = sum * t % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据约数个数和乘法原理可得约数和公式</p>
<script type="math/tex; mode=display">
f(n) = (p_1^0 + p_1^1 + p_1^2...p_1^{a1})*(p_2^0 + p_2^1 + p_2^2...p_2^{a2})...
(p_k^0 + p_k^1 + p_k^2...p_k^{ak})</script><p><a href="https://baike.baidu.com/item/约数和定理" target="_blank" rel="noopener">约数之和定理</a></p>
<hr>
<h5 id="最大公约数"><a href="#最大公约数" class="headerlink" title="最大公约数"></a>最大公约数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a % b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://baike.baidu.com/item/欧几里得算法" target="_blank" rel="noopener">欧几里得算法证明</a></p>
<blockquote>
<p>证 a , b 和 b , a % b 的公约数一样</p>
<p>假设d 是 a,b 的一个公约数 记作 <script type="math/tex">d |a , d | b</script></p>
<script type="math/tex; mode=display">
a = k * b + r</script><script type="math/tex; mode=display">
a \mod b = r =  a - k * b</script><script type="math/tex; mode=display">
\frac{r}{d} = \frac{a}{d} + \frac{k *d}{d}</script><p>等式右边必然是一个整数 </p>
<p>所以 d 也是 r 的约数</p>
<p>证毕</p>
</blockquote>
<p>​    为什么是最大公约数？  <script type="math/tex">b = 0</script></p>
<p><a href="https://baike.baidu.com/item/更相减损术" target="_blank" rel="noopener">更相减损法</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/01/30/%E7%BA%A6%E6%95%B0/" data-id="ck6kcke0x000fakdp0cqrejvg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-质数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/30/%E8%B4%A8%E6%95%B0/" class="article-date">
  <time datetime="2020-01-30T11:58:04.000Z" itemprop="datePublished">2020-01-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/30/%E8%B4%A8%E6%95%B0/">质数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="判断某个数是否是质数"><a href="#判断某个数是否是质数" class="headerlink" title="判断某个数是否是质数"></a>判断某个数是否是质数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">is_prime</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>i &lt;= n / i 是为了防止 i * i &lt;= n 溢出</p>
<hr>
<h5 id="分解质因子"><a href="#分解质因子" class="headerlink" title="分解质因子"></a>分解质因子</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n / i; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">                n /= i;</span><br><span class="line">                cnt++;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(i + <span class="string">" "</span> + cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) System.out.println(n + <span class="string">" 1"</span>);</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>i &lt;= n / i  是因为 n 中 最多只有一个大于等于 sqrt(n) 的质因子</p>
<p>最后只要判断下n最后是否为 1  时间复杂度从 O(n) -&gt; O(sqrt(n))</p>
<p>最优时间复杂度 是比上面的优秀 当 n 为 2的次幂 时O(logn)</p>
<p>而上面的 一直是 O(sqrt(n))</p>
<hr>
<h5 id="筛质数"><a href="#筛质数" class="headerlink" title="筛质数"></a>筛质数</h5><h6 id="朴素筛法"><a href="#朴素筛法" class="headerlink" title="朴素筛法"></a>朴素筛法</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] primes = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">boolean</span>[] st = <span class="keyword">new</span> <span class="keyword">boolean</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + i; j &lt;= n; j += i) &#123;</span><br><span class="line">            st[j] = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="埃氏筛"><a href="#埃氏筛" class="headerlink" title="埃氏筛"></a>埃氏筛</h6><p>对朴素筛法优化 只要质数需要对之后数进行筛操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] primes = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">boolean</span>[] st = <span class="keyword">new</span> <span class="keyword">boolean</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) &#123;</span><br><span class="line">            primes[cnt++] = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + i; j &lt;= n; j += i) &#123;</span><br><span class="line">                st[j] = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> N = <span class="number">1000010</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span>[] primes = <span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">boolean</span>[] st = <span class="keyword">new</span> <span class="keyword">boolean</span>[N];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">get_primes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!st[i]) primes[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; primes[j] &lt;= n / i; ++j) &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % primes[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据每个数的最小质因子来筛取每个数</p>
<p>primes[j] &lt;= n / i  =&gt; primes[j]  * i  &lt;= n</p>
<ul>
<li>i 是 合数 那么primes[j]中 一定有其最小质因数 会从 if break</li>
</ul>
<ul>
<li>i 是 质数 那么循环前已经在 primes 中 加入该数 如果之前没有结束 最后也会从if break</li>
</ul>
<ul>
<li>primes[j] 一直是 i * primes[j] 的最小质因子</li>
</ul>
<p>质数 x = i * primes[j] 最小质因子 乘一个 i</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://chu8aa.github.io/2020/01/30/%E8%B4%A8%E6%95%B0/" data-id="ck6kcke12000sakdpcl67hct1" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 10px;">动态规划</a> <a href="/tags/%E5%9F%BA%E7%A1%80/" style="font-size: 10px;">基础</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 20px;">数学</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/13/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/">背包问题</a>
          </li>
        
          <li>
            <a href="/2020/02/10/%E7%BB%84%E5%90%88%E6%95%B0/">组合数</a>
          </li>
        
          <li>
            <a href="/2020/02/09/%E9%AB%98%E6%96%AF%E6%B6%88%E5%85%83/">高斯消元</a>
          </li>
        
          <li>
            <a href="/2020/02/08/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/">中国剩余定理</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E6%8B%93%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95/">拓展欧几里得算法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 chu8aa<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>
</html>